@using Newtonsoft.Json
@model RegisterViewModel
@{
    ViewData["Title"] = "Register";
}

<h2 class="ui header">@ViewData["Title"]</h2>

<div class="ui left floated raised very padded text container segment">
    <form class="ui form" asp-route-returnUrl="@ViewData["ReturnUrl"]" method="post">
        <div class="ui error message"></div>
        <div class="field">
            <label asp-for="Username"></label>
            <input asp-for="Username" />
        </div>
        <div class="field">
            <label asp-for="Password"></label>
            <input asp-for="Password" />
        </div>
        <div class="field">
            <label asp-for="ConfirmPassword"></label>
            <input asp-for="ConfirmPassword" />
        </div>
        <button type="submit" class="ui button">Register</button>
    </form>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            $('.ui.form').form({
                fields: {
                    Username        : 'empty',
                    Password        : 'empty',
                    ConfirmPassword : 'empty'
                }
            });
            $('.ui.form').form({
                on: 'blur',
                fields: {
                    match: {
                        identifier: 'ConfirmPassword',
                        rules: [
                            {
                                type: 'match[Password]',
                                prompt: 'Please put the same value in both fields'
                            }
                        ]
                    }
                }
            });
            var jsonModel = @Html.Raw(JsonConvert.SerializeObject(Model));
            if (jsonModel !== null) {
                $('.form .error.message').html('Registration failed: Password must be at least 6 characters long').show();
            };
        });
    </script>
}